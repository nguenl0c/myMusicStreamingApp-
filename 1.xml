<mxfile host="app.diagrams.net">
  <diagram name="Unified Playlist System Architecture" id="unifiedPlaylistSystem">
    <mxGraphModel dx="1200" dy="700" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        <!-- Title -->
        <mxCell id="title" value="HỆ THỐNG DANH SÁCH PHÁT THỐNG NHẤT (UNIFIED PLAYLIST SYSTEM)" style="text;html=1;fontSize=15;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="10" width="500" height="24" as="geometry"/>
        </mxCell>
        <!-- Giao diện người dùng -->
        <mxCell id="ui" value="GIAO DIỆN NGƯỜI DÙNG" style="swimlane;html=1;rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="580" height="70" as="geometry"/>
        </mxCell>
        <mxCell id="ui1" value="UnifiedPlaylists.jsx\n(Quản lý Playlist)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="ui">
          <mxGeometry x="8" y="34" width="130" height="36" as="geometry"/>
        </mxCell>
        <mxCell id="ui2" value="PlayUnifiedPlaylist.jsx\n(Phát nhạc)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="ui">
          <mxGeometry x="158" y="34" width="130" height="36" as="geometry"/>
        </mxCell>
        <mxCell id="ui3" value="UnifiedPlayer.jsx\n(Điều khiển)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="ui">
          <mxGeometry x="308" y="34" width="130" height="36" as="geometry"/>
        </mxCell>
        <!-- Logic nghiệp vụ -->
        <mxCell id="logic" value="LỚP LOGIC NGHIỆP VỤ" style="swimlane;html=1;rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="40" y="120" width="580" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="logicjs" value="UnifiedPlaylistManager.js" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="logic">
          <mxGeometry x="8" y="30" width="180" height="36" as="geometry"/>
        </mxCell>
        <mxCell id="logic1" value="createPlaylist\n\n deletePlaylist" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="logic">
          <mxGeometry x="200" y="30" width="90" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="logic2" value="addTrackToList\n\nremoveTrack" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="logic">
          <mxGeometry x="295" y="30" width="90" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="logic3" value="reorderPlaylist\n\nimportSpotify" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="logic">
          <mxGeometry x="390" y="30" width="90" height="50" as="geometry"/>
        </mxCell>
        <!-- Trừu tượng hóa dữ liệu -->
        <mxCell id="dataabs" value="LỚP TRỪU TƯỢNG HÓA DỮ LIỆU" style="swimlane;html=1;rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="40" y="230" width="580" height="90" as="geometry"/>
        </mxCell>
        <mxCell id="dataabsjs" value="UnifiedTrack.js" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="dataabs">
          <mxGeometry x="8" y="30" width="180" height="36" as="geometry"/>
        </mxCell>
        <mxCell id="factory1" value="fromSpotifyTrack\n(Factory)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="dataabs">
          <mxGeometry x="200" y="30" width="90" height="36" as="geometry"/>
        </mxCell>
        <mxCell id="factory2" value="fromLocalTrack\n(Factory)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="dataabs">
          <mxGeometry x="295" y="30" width="90" height="36" as="geometry"/>
        </mxCell>
        <mxCell id="factory3" value="fromStemTrack\n(Factory)" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="dataabs">
          <mxGeometry x="390" y="30" width="90" height="36" as="geometry"/>
        </mxCell>
        <!-- Lớp dữ liệu -->
        <mxCell id="datalayer" value="LỚP DỮ LIỆU" style="swimlane;html=1;rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="40" y="330" width="580" height="110" as="geometry"/>
        </mxCell>
        <mxCell id="spotifyapi" value="Spotify API\n(External API)\n• Search tracks\n• Get metadata\n• OAuth2 auth" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="datalayer">
          <mxGeometry x="8" y="30" width="150" height="66" as="geometry"/>
        </mxCell>
        <mxCell id="indexeddb" value="IndexedDB\n(Local Files)\n• Store audio\n• Blob URLs\n• File metadata" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="datalayer">
          <mxGeometry x="170" y="30" width="150" height="66" as="geometry"/>
        </mxCell>
        <mxCell id="localstorage" value="localStorage\n(Playlists)\n• Store meta\n• Sync data\n• Quick access" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="datalayer">
          <mxGeometry x="332" y="30" width="150" height="66" as="geometry"/>
        </mxCell>
        <!-- Lớp phát nhạc -->
        <mxCell id="playerlayer" value="LỚP PHÁT NHẠC" style="swimlane;html=1;rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="40" y="460" width="580" height="100" as="geometry"/>
        </mxCell>
        <mxCell id="dualengine" value="Dual-Player Engine" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=13;" vertex="1" parent="playerlayer">
          <mxGeometry x="170" y="34" width="220" height="34" as="geometry"/>
        </mxCell>
        <mxCell id="spotifywebsdk" value="Spotify Web SDK\n• Remote tracks\n• Web Playback\n• State sync" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="playerlayer">
          <mxGeometry x="8" y="74" width="150" height="54" as="geometry"/>
        </mxCell>
        <mxCell id="html5audioapi" value="HTML5 Audio API\n• Local tracks\n• File playback\n• Progress track" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;strokeColor=#6c8ebf;" vertex="1" parent="playerlayer">
          <mxGeometry x="332" y="74" width="150" height="54" as="geometry"/>
        </mxCell>
        <!-- Arrows between layers -->
        <mxCell id="e1" style="endArrow=block;html=1;" edge="1" parent="1" source="ui" target="logic">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e2" style="endArrow=block;html=1;" edge="1" parent="1" source="logic" target="dataabs">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e3" style="endArrow=block;html=1;" edge="1" parent="1" source="dataabs" target="datalayer">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e4" style="endArrow=block;html=1;" edge="1" parent="1" source="datalayer" target="playerlayer">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <!-- Engine arrows -->
        <mxCell id="e5" style="endArrow=block;html=1;" edge="1" parent="1" source="spotifywebsdk" target="dualengine">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e6" style="endArrow=block;html=1;" edge="1" parent="1" source="html5audioapi" target="dualengine">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <!-- Engine sync -->
        <mxCell id="e7" value="stopAllPlayers()" style="endArrow=block;html=1;" edge="1" parent="playerlayer" source="dualengine" target="spotifywebsdk">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e8" value="stopAllPlayers()" style="endArrow=block;html=1;" edge="1" parent="playerlayer" source="dualengine" target="html5audioapi">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
